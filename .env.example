# .env.example
# PostgreSQL Configuration
POSTGRES_DB=portfolio_db
POSTGRES_USER=user
POSTGRES_PASSWORD=password
DATABASE_URL=postgresql://user:password@postgres:5432/portfolio_db

# --- NEW: Read Replica URL for the Query Service ---
# In production, this would point to a read-replica. For local dev, it defaults to the primary DB.
QUERY_DATABASE_URL=${DATABASE_URL}

# MongoDB Configuration (Optional)
MONGO_INITDB_ROOT_USERNAME=admin
MONGO_INITDB_ROOT_PASSWORD=password

# Kafka Configuration
KAFKA_BROKER_ID=1
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9093,PLAINTEXT_HOST://localhost:9092
KAFKA_RAW_TRANSACTIONS_TOPIC=raw_transactions
KAFKA_RAW_TRANSACTIONS_COMPLETED_TOPIC=raw_transactions_completed

# Kafka URL for tools running on the host machine (e.g., pytest)
KAFKA_BOOTSTRAP_SERVERS_HOST=localhost:9092

# Database URL for tools running on the host machine (e.g., alembic) connecting to Docker
HOST_DATABASE_URL=postgresql://user:password@localhost:5432/portfolio_db

# Demo data pack bootstrap (set false to skip auto ingest/verify at compose startup)
DEMO_DATA_PACK_ENABLED=true

# Adapter-mode ingestion endpoints (non-canonical; recommended true only for UI/demo/manual onboarding)
LOTUS_CORE_INGEST_PORTFOLIO_BUNDLE_ENABLED=true
LOTUS_CORE_INGEST_UPLOAD_APIS_ENABLED=true

# Ingestion operations authorization and safety controls
LOTUS_CORE_INGEST_OPS_AUTH_MODE=token_or_jwt
LOTUS_CORE_INGEST_OPS_TOKEN_REQUIRED=true
LOTUS_CORE_INGEST_OPS_TOKEN=lotus-core-ops-local
LOTUS_CORE_INGEST_OPS_JWT_HS256_SECRET=
LOTUS_CORE_INGEST_OPS_JWT_ISSUER=
LOTUS_CORE_INGEST_OPS_JWT_AUDIENCE=
LOTUS_CORE_INGEST_OPS_JWT_CLOCK_SKEW_SECONDS=60

# Ingestion write path rate limiting
LOTUS_CORE_INGEST_RATE_LIMIT_ENABLED=true
LOTUS_CORE_INGEST_RATE_LIMIT_WINDOW_SECONDS=60
LOTUS_CORE_INGEST_RATE_LIMIT_MAX_REQUESTS=120
LOTUS_CORE_INGEST_RATE_LIMIT_MAX_RECORDS=10000
